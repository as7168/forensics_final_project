# Forensics Final Project - Pcap Visualizer

## Objective

The purpose of this project is to create an open source tool to visualize a pcap file.
The tool is able to input a pcap file and output a visual representation of the network depicted in the pcap file.
Furthermore, it also shows the type of protocols/services being used by the nodes/hosts in the network.

## Dependencies


## Usage

usage: pcap_parser_project.py [-h] [-i IP_ADDR] [-b START] [-f END] [-r] pcap outfile

### Mandatory Arguments

#### 1. Pcap file
Input pcap file to be processed by the tool. This file must be in the same directory as the tool (pcap_parser_project.py)
#### 2. Output image file name
Name of the image file you want the graph (generated by the tool) to be stored as
### Optional Arguments

#### 1. IP Address (-i <ip address> --ip_addr=<ip address>)
If you want to focus the analysis on a specific IP address, you can give that ip address and the tool will only display the connections related to that ip address
#### 2. Starting Connection Edge (-b <edge number> --start=<edge number>)
If the visual representation of the network gets too clustered, you can use this argument along with -f argument to limit the number of connection edges  you want to see in the graph. This argument is the starting connection edge you want to see out of the available connection edges. You must use -f argument if you use this argument. Default value of this argument is 0.
#### 3. Ending Connection Edge (-f <edge number> --end=<edge number>)
This argument is the upper limit of the connection edges you want to see. You must use this argument if you use -b argument.
#### 4. Recurse (-r --recurse)
This option can be set if you have given a specific IP address to analyze and you also want to see the network connections the nodes connected to this IP address are making.
  
## Methodology

At first, I tried to use pypcapfile python package https://pypi.python.org/pypi/pypcapfile to parse through the entire pcap file and extract the required information. This package provides an easy way to load all packets from the pcap file, however, it lacks functionality to extract application layer protocol. Moreover it extends ctypes.Structure class for its link, network and transport layer protocols. So I decided to write my own link, network and transport layer classes to handle those layer. I referenced pypcapfile package for this purpose. My classes do not use any ctypes and are easy to use. The tool parses through each packet in the pcap file and extracts ethernet header, network header and transport layer frame finally inferring the application layer protocol. 
Each node is represented by a set of IP address and ethernet address. No two nodes will have the same IP address and ethernet address combination. Each edge is a combination of two nodes.
